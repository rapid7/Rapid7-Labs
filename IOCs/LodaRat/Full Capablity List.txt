|        Tactic        |                                     Technique                                     |                                                                                                                                                                       Description                                                                                                                                                                       |
|:--------------------:|:---------------------------------------------------------------------------------:|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------:|
| Execution            | User Execution: Malicious Link (T1204.001)                                        | Create a new shortcut(.lnk) to execute itself. Create a %TEMP%/Q.lnk shortcut to connect external resources.                                                                                                                                                                                                                                            |
|                      | Command and Scripting Interpreter: Windows Command Shell (T1059.003)              | Execute a specified by C&C file by using `cmd.exe`.                                                                                                                                                                                                                                                                                                     |
|                      | Graphical User Interface (T0823)                                                  | Control mouse clicks and movements. Send {Enter} and {Backspace} keys to the keyboard.                                                                                                                                                                                                                                                                  |
|                      | User Execution: Malicious File (T1204.002)                                        | Execute file from path.                                                                                                                                                                                                                                                                                                                                 |
| Privilege Escalation | Access Token Manipulation (T1134)                                                 | Use runas command to run a VBS script.                                                                                                                                                                                                                                                                                                                  |
|                      | Event Triggered Execution: Image File Execution Options Injection (T1546.012)     | Set HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\Debugger registry key to 1.                                                                                                                                                                                                                                          |
| Persistence          | Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder (T1547.001) | Copy self to All users startup folder (C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp)                                                                                                                                                                                                                                                    |
|                      | Create Account (T1136)                                                            | Create a new local user and add it to local Administrators group by executing cmd.exe /c net user /add <Username> -Guest 123 & net localgroup Administrators <Username> -Guest /add  & net localgroup Administrateurs <Username> -Guest /add command.                                                                                                   |
|                      | Scheduled Task/Job (T1053)                                                        | Create a scheduled task that will execute compiled AutoIt malware every minute.                                                                                                                                                                                                                                                                         |
| Defense Evasion      | Modify Registry (T1112)                                                           | Set the following values under HKCU\Software\Win32 registry key to store data: Key Key2 keyx data imgCli img Create and delete registry keys.                                                                                                                                                                                                           |
|                      | Deobfuscate/Decode Files or Information (T1140)                                   | Decrypt encrypted data received from C&C server.                                                                                                                                                                                                                                                                                                        |
|                      | Hide Artifacts: Hidden Window (T1564.003)                                         | Execute binaries in a hidden window. Manipulate the application window state.                                                                                                                                                                                                                                                                           |
|                      | Impair Defenses: Disable or Modify Tools(T1562.001)                               | Disable an RDP access to the victim's endpoint by setting HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\fDenyTSConnections registry key to 0.                                                                                                                                                                                                   |
|                      | Impair Defenses: Disable or Modify System Firewall (T1562.004)                    | Disable system Firewall by executing `cmd.exe /c netsh advfirewall set allprofiles state off command.                                                                                                                                                                                                                                                   |
|                      | Impair Defenses (T1562)                                                           | Disable the Limit Black Password use setting by setting HKLM\SYSTEM\CurrentControlSet\Control\Lsa\LimitBlankPasswordUse registry key to 0.                                                                                                                                                                                                              |
|                      | Virtualization/Sandbox Evasion: Time Based Evasion (T1497.003)                    | Utilize long sleeps between actions to evade detection.                                                                                                                                                                                                                                                                                                 |
|                      | Deobfuscate/Decode Files or Information (T1140)                                   | Unzip files received from C&C server.                                                                                                                                                                                                                                                                                                                   |
|                      | Indicator Removal (T1070)                                                         | Delete all persistence mechanisms and AutoIt binary.                                                                                                                                                                                                                                                                                                    |
| Credential Access    | Unsecured Credentials: Credentials In Files (T1552.001)                           | Read recentservers.xml under filezilla directory and extract the Host,User,Pass data from the file.                                                                                                                                                                                                                                                     |
|                      | Credentials from Password Stores: Credentials from Web Browsers (T1555.003)       | Steal Firefox, Google Chrome, Opera, Microsoft Edge and Brave browser’s stored credentials.                                                                                                                                                                                                                                                             |
|                      | Steal Web Session Cookie (T1539)                                                  | Steal Firefox, Google Chrome, Opera, Microsoft Edge and Brave browser’s cookies.                                                                                                                                                                                                                                                                        |
| Discovery            | Software Discovery (1418)                                                         | Enumerate 200 keys under HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Uninstall registry keys and collect DisplayName, DisplayVersion and Publisher values for each key.                                                                                                                                                                |
|                      | Query Registry (T1012)                                                            | Enumerate registry keys and values under a received from C&C server key.                                                                                                                                                                                                                                                                                |
|                      | System Network Configuration Discovery: Wi-Fi Discovery (T1016.002)               | Enumerate Wi-Fi names by executing netsh wlan show profiles command and executes a netsh wlan show profiles #Name key=clear command to show network’s corresponding password.                                                                                                                                                                           |
|                      | File and Directory Discovery (T1083)                                              | Checks installed browsers by checking for existence of browser files. Enumerates the .txt file in the mon folder. Enumerate files in folders and send the list to C&C server. Retrieves file/ directory size. Enumerate files under the following folders  %User%/Desktop %User%/Pictures %User%/Music %User% %Startup% %Appdata% %CurrectFolder%       |
|                      | Remote System Discovery (T1018)                                                   | Read data from C:\Windows\system32\Drivers\etc\hosts file.                                                                                                                                                                                                                                                                                              |
|                      | System Network Connections Discovery (T1049)                                      | Executes netstat -n -b -o or netstat -n -o commands to discover TCP connections and their source processes.                                                                                                                                                                                                                                             |
|                      | System Network Configuration Discovery: Internet Connection Discovery (T1016.001) | Obtains Host’s IP and uses ping to discover other connected endpoints in the segment. Checks victim’s external IP by accessing `hxxp[:]//checkip.amazonaws[.]com/` url.                                                                                                                                                                                 |
|                      | Application Window Discovery (T1010)                                              | Lists open application’s windows.                                                                                                                                                                                                                                                                                                                       |
|                      | Process Discovery (T1057)                                                         | Query if specified by C&C process is running. Get a running process list.                                                                                                                                                                                                                                                                               |
|                      | Network Share Discovery (T1135)                                                   | Enumerate attached drives.                                                                                                                                                                                                                                                                                                                              |
|                      | System Information Discovery (T1082)                                              | Discover OS version, RAM size, Firewall and AV status.                                                                                                                                                                                                                                                                                                  |
| Lateral Movement     | Remote Services: SMB/Windows Admin Shares (T1021.002)                             | Attempt to spread to additional hosts by exploiting SMB vulnerability.                                                                                                                                                                                                                                                                                  |
| Collection           | Data from Local System (T1005)                                                    | Collect an .lnk file data.                                                                                                                                                                                                                                                                                                                              |
|                      | Clipboard Data (T1115)                                                            | Read and set clipboard data.                                                                                                                                                                                                                                                                                                                            |
|                      | Archive Collected Data (T1560)                                                    | Zip files.                                                                                                                                                                                                                                                                                                                                              |
|                      | Audio Capture (T1123)                                                             | Record microphone sounds using Windows Sound Recorder.                                                                                                                                                                                                                                                                                                  |
|                      | Screen Capture (T1113)                                                            | Capture the user's screen.                                                                                                                                                                                                                                                                                                                              |
|                      | Video Capture (T1125)                                                             | Record Webcam.                                                                                                                                                                                                                                                                                                                                          |
| Command and Control  | Ingress Tool Transfer (T1105)                                                     | Download files from url. Drop files on the system Downloads and utilizes ngrok reverse proxy. Downloads EternalBlue exploitation utility. Downloads from C&C server the following libraries: bass.dll,bacb.dll, baenc.dll,es.dll. Downloads from C&C server three unknown binaries: lamx.exe,xr.exe and p12.exe. Download and play .wav files from C&C. |
| Exfiltration         | Exfiltration Over C2 Channel (T1041)                                              | Read files and send the content to C&C. Send all collected information to C&C server. Exfiltrate all .jpg, .png, .gif, .bmp files from specified by C&C server directory.                                                                                                                                                                               |
| Impact               | Data Manipulation: Stored Data Manipulation (T1565.001)                           | Move files and directories from a received from C&C path. Copy files to another directory. Delete files. Replace or add content to C:\Windows\system32\Drivers\etc\hosts file.                                                                                                                                                                          |
|                      | Account Access Removal (T1531)                                                    | Delete previously created user by executing a following command: cmd.exe /c net user #current user# -Guest  /delete.                                                                                                                                                                                                                                    |
|                      | Service Stop (T1489)                                                              | Terminate wmplayer.exe process. Terminate or relaunch self process. Terminate specified by C&C process.                                                                                                                                                                                                                                                 |
|                      | System Shutdown/Reboot (T1529)                                                    | Shutdown or reboot the victim's host, or log-off the user.                                                                                                                                                                                                                                                                                              |
|                      | Defacement: Internal Defacement (T1491.001)                                       | Set or remove a desktop wallpaper.                                                                                                                                                                                                                                                                                                                      |